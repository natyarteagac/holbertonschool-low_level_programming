More funcitions, more nested loops
